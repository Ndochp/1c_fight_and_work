# Система компоновки данных

## Полезные функции (пока без описаний)

* СоединитьСтроки()
* Массив()

## Работа из кода

### Программная установка сортировки / отбора
В принципе, есть компоновщик настроек, в нем аж 3 вида настроек: фиксированные, просто и пользовательские. 
* Фиксированные использовать сразу нельзя - если не дай бог пользователь отберется по тому же полю, то вместо ожидаемого И между настройками произойдет падение с исключением.
* На просто настройки такое ощущение что 1С не реагирует вообще, если есть пользовательские
* Пользовательские настройки сделаны максимально через одно место. Если в остальных можно получать отбор, порядок и тд по имени, то в пользовательских есть Элементы, и по типу элемента надо искать и отбор и порядок и все, что надо. 
Таким образом, если настройка не железобетонная, а например, сортировка по умолчанию. То надо искать ее в пользовательских, и дальше производить манипуляции. При том, если мы не хотим запороть настройку, которую использует пользователь в обычной жизни, то надо задать заранее свой ключ настройки, мы после этого получим настройки по умолчанию. Их превратить в то что надо и показывать пользователю.

```bsl
Процедура ОткройФормуСПорядком()
    ПараметрыОткрываемойФормы = Новый Структура();
    ПараметрыОткрываемойФормы.Вставить("Отбор", Новый Структура("Ключ", Значение));
    ПараметрыОткрываемойФормы.Вставить("КлючПользовательскихНастроек", "НашГУИД");
    
    ФормаСостояний = ПолучитьФорму(ИмяФормыДинамическогоСписка, ПараметрыОткрываемойФормы, ЭтотОбъект);
    
    ПользовательскиеНастройкиПорядка = ПользовательскиеНастройкиПорядка(ФормаСостояний);
    Настройки = ФормаСостояний.Список.КомпоновщикНастроек.Настройки;
    ПользовательскиеНастройкиПорядка.Элементы.Очистить();
    ПорядокПериод = ПользовательскиеНастройкиПорядка.Элементы.Добавить(Тип("ЭлементПорядкаКомпоновкиДанных"));
    ПорядокПериод.Использование = Истина;
    ПорядокПериод.Поле = Новый ПолеКомпоновкиДанных("Период");
    ПорядокПериод.РежимОтображения = РежимОтображенияЭлементаНастройкиКомпоновкиДанных.БыстрыйДоступ;
    ПорядокПериод.ТипУпорядочивания = НаправлениеСортировкиКомпоновкиДанных.Убыв;
    
    ФормаСостояний.Открыть();
КонецПроцедуры

Функция ПользовательскиеНастройкиПорядка(ФормаСоСписком)
    Перем Рез;
    Список = ФормаСоСписком[ФормаСоСписком.НаименованиеРеквизитаФормыДинамическийСписок];
    Настройки = Список.КомпоновщикНастроек.ПользовательскиеНастройки;
    Для каждого НастройкаКомпоновщика Из Настройки.Элементы Цикл
        Если ТипЗнч(НастройкаКомпоновщика) = Тип("ПорядокКомпоновкиДанных") Тогда
            Рез = НастройкаКомпоновщика;
            Прервать;
        КонецЕсли;
    КонецЦикла;
    Возврат Рез;
КонецФункции
```
# Ссылки
[Платформа 1С](Платформа%201С.md)
[[Динамический список]]
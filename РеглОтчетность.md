# Tips&Tricks реглотчетности

## Удалить строки многострочной части

### Что делает:
Позволяет удалить строки многострочного "ручного" раздела массово, а не по одной.

### Сделано для:
* 1С:ERP Управление предприятием 2 (2.4.11.106) (http://v8.1c.ru/erp/)
* Отчет: РегламентированныйОтчетБухОтчетность, ФормаОтчета2019Кв1

Никакая специфика не используется, все на уровне служебного неэкспортированного API
### Пользовательское описание:
1. Выделить строки многострочного раздела, которые необходимо удалить (раздел должен быть один, типовая кнопка удаления одной строки должна быть доступна)
2. нажать на новую кнопку "Удалить строки"


### Код:
Добавить команду "Удалить строки" со следующим обработчиком:
``` 1C
&НаКлиенте
Процедура ус_УдалитьСтрокиПосле(Команда)
	Перем ТекущаяОбласть;
	ТекущаяОбласть = ТабличныйДокумент.ТекущаяОбласть;
	ИмяПервойСтроки = ТабличныйДокумент.Область(ТекущаяОбласть.Верх, ТекущаяОбласть.Лево).Имя;
	ИмяПоследнейСтроки = ТабличныйДокумент.Область(ТекущаяОбласть.Низ, ТекущаяОбласть.Лево).Имя;
	Если ИмяПоказателяБезСчетчика(ИмяПервойСтроки) <> ИмяПоказателяБезСчетчика(ИмяПоследнейСтроки) Тогда
		ПоказатьПредупреждение(,НСтр("ru='Должны быть выделены строки одного раздела"));
		Возврат;
	КонецЕсли;
	
	Низ = ТекущаяОбласть.Низ;
	
	Для ДельтаСтроки = 0 по ТекущаяОбласть.Низ - ТекущаяОбласть.Верх цикл
		ИмяПоказателя = ТабличныйДокумент.Область(Низ - ДельтаСтроки, ТекущаяОбласть.Лево).Имя;
		ДополнительныеПараметры = Новый Структура("ИмяПоказателя", ИмяПоказателя);
		УдалитьСтрокуЗавершение(КодВозвратаДиалога.Да, ДополнительныеПараметры);
	КонецЦикла;
КонецПроцедуры

```
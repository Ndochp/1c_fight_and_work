## Управления текстом задач в зависимости от предмета
Всем привет.
Придумал, можно сказать «выстрадал», способ управления текстом задач, чтобы можно было менять его в зависимости от предмета, тащить в текст задачи различные реквизиты предмета.
И чтобы это работало в режиме сервиса, и чтобы не снимать объекты с поддержки. И чтоб не ждать регламентного задания. Решение не лежит на поверхности, поэтому вот делюсь.

В начале процесса (или не вначале, но до точки, в которой нужно менять текст задачи) ставим кубик «Действие». В действии нужно найти шаблон точки текущего комплексного процесса по наименованию и в нем заменить текст.
Вот пример кода.

``` 1c
Запрос = Новый Запрос;
Запрос.УстановитьПараметр("КомплексныйПроцесс", КомплексныйПроцесс);
Запрос.УстановитьПараметр("НаименованиеШаблона", "Заполнить реквизиты Запроса на оплату корпоративной картой, приложить файлы");
Запрос.УстановитьПараметр("ПустаяСтрока", "");
Запрос.Текст =
"ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
|    КомплексныйПроцессПредметыЗадач.ШаблонБизнесПроцесса КАК ШаблонБизнесПроцесса
|ИЗ
|    БизнесПроцесс.КомплексныйПроцесс.ПредметыЗадач КАК КомплексныйПроцессПредметыЗадач
|ГДЕ
|    КомплексныйПроцессПредметыЗадач.Ссылка = &КомплексныйПроцесс
|    И КомплексныйПроцессПредметыЗадач.ШаблонБизнесПроцесса.Наименование = &НаименованиеШаблона
|;
|
|////////////////////////////////////////////////////////////////////////////////
|ВЫБРАТЬ РАЗРЕШЕННЫЕ
|    ЕСТЬNULL(КомплексныйПроцессПредметы.Предмет.Содержание, &ПустаяСтрока) КАК Содержание
|ИЗ
|    БизнесПроцесс.КомплексныйПроцесс.Предметы КАК КомплексныйПроцессПредметы
|ГДЕ
|    КомплексныйПроцессПредметы.Ссылка = &КомплексныйПроцесс
|    И КомплексныйПроцессПредметы.НомерСтроки = 1";
Результаты = Запрос.ВыполнитьПакет();

ВыборкаШаблон = Результаты[0].Выбрать();
Если ВыборкаШаблон.Следующий() Тогда
     
     ШаблонБизнесПроцесса = ВыборкаШаблон.ШаблонБизнесПроцесса.ПолучитьОбъект();
     ШаблонБизнесПроцесса.ОбменДанными.Загрузка = Истина;
     
     ВыборкаСодержание = Результаты[1].Выбрать();
     Если ВыборкаСодержание.Следующий() Тогда
          ШаблонБизнесПроцесса.Описание = СтрЗаменить(ШаблонБизнесПроцесса.Описание, "[Содержание]",
                ВыборкаСодержание.Содержание);
     КонецЕсли;
     
     ШаблонБизнесПроцесса.Записать();
     
КонецЕсли;
```

С уважением,
Андрей Назаров
Программист-аналитик 

## Отправка почты 
Отправка почты в ДО довольно многогранна, и даже если тебе кажется, что ты нашел то, что нужно  - это только кажется

* ЛегкаяПочтаСервер.ОтправитьИнтернетПочта - рекомендовано представителем 1С, в живую не проверял [Рекомендация](https://partners.v8.1c.ru/forum/message/1920140?onlyMyThemesInput=true#m_1920140)
``` 1C 
ЛегкаяПочтаСервер.ОтправитьИнтернетПочта( ПараметрыОтправки, Знач УчетнаяЗапись = Неопределено, Знач Пароль = Неопределено, СообщениеОбОшибке = Неопределено, Знач Соединение = Неопределено) Экспорт
````


* Почта.ОтправитьСообщение - требует живого соединения, у меня не взлетело

``` 1C
Почта.ОтправитьСообщение(    Соединение,    ПараметрыОтправки,    СообщениеОбОшибке = Неопределено,    УчетнаяЗапись = Неопределено) Экспорт
```
* РаботаСПочтовымиСообщениями.ОтправитьПочтовоеСообщение - не позволяет указать заголовки
``` 1C
РаботаСПочтовымиСообщениями.ОтправитьПочтовоеСообщение(Знач УчетнаяЗапись,  Знач ПараметрыПисьма, Знач Соединение = Неопределено) Экспорт
```


# БСП

## Многопоточность
Подсистема ДлительныеОперации, функции [`ВыполнитьФункциюВНесколькоПотоков`](https://its.1c.ru/db/bsp3110doc/content/33/hdoc/_top/%D0%B2%D1%8B%D0%BF%D0%BE%D0%BB%D0%BD%D0%B8%D1%82%D1%8C%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8E%D0%B2%D0%BD%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE%D0%BF%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%B2), аналогично процедуру. Параметры порционно складывать в соответствие. #надоСделать найти инфо про динамическое создание порций.
Обязательно передавать внешку как двоичные данные. Сколько бы ни было порций, все выполняется в ограниченном (дефолт 3) числе потоков, рулится константой. Один поток - управляющий, так что реально идет в `константа - 1` поток.
Интерфейс менялся, как минимум брейкинг чейндж был в 3,1,17

В возвращаемом значении лежит адрес результата управляющего потока, в котором лежит структура со статусами каждого из потоков.

Статьи:
1. https://wiki.programstore.ru/ispolzovanie-tipovogo-mexanizma-mnogopotochnosti-bsp/
2. https://xn----1-bedvffifm4g.xn--p1ai/articles/%D0%BA%D0%B0%D0%BA-%D1%83%D1%81%D0%BA%D0%BE%D1%80%D0%B8%D1%82%D1%8C-1%D1%81-%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE%D0%BF%D0%BE%D1%82%D0%BE%D1%87%D0%BD%D0%BE%D1%81%D1%82%D1%8C/
## Вывод окна ожидания с подсказкой прогресса
Для сообщения прогресса нужно 2 момента:
1. внутри процедуры фонового задания нужно вызывать
``` js
    ДлительныеОперации.СообщитьПрогресс(процент, текст, допы);
```
1. к стандартному ожиданию завершения:
``` 
	ДлительныеОперацииКлиент.ОжидатьЗавершение(ДлительнаяОперация, ОповещениеОЗавершении, ПараметрыОжидания)
```
  
   добавляется обязательное заполнение реквизита 

```js
	ПараметрыОжидания.ВыводитьПрогрессВыполнения = Истина;
```

Не забывайте, на стандартной форме ожидания прогресс бара нет, но она готов вывести текст в виде "процент (текст)" например 
```
15.325 (153 из 1018)
```

## Подсистемы
### Контактная информация
Найти вид КИ по идентификатору для формул: 
Судя по проверке уникальности допустимо указания одинаковых ИД для разных верхних папок, поэтому в 2 параметра.
```js
Функция ВидКонтактнойИнформацииПоИдентификатору(Идентификатор, РодительВерхнегоУровня)
	Перем Запрос, ТЗ;
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	Таблица.Ссылка
	|ИЗ
	|	Справочник.ВидыКонтактнойИнформации КАК Таблица
	|ГДЕ
	|	И Таблица.Ссылка В ИЕРАРХИИ (&РодительВерхнегоУровня)
	|	И Таблица.ИдентификаторДляФормул = &ИдентификаторДляФормул";
	Запрос.УстановитьПараметр("ИдентификаторДляФормул", Идентификатор);
	Запрос.УстановитьПараметр("РодительВерхнегоУровня", РодительВерхнегоУровня);
	
	ТЗ = Запрос.Выполнить().Выгрузить();
	Если ТЗ.Количество() = 0 Тогда
		Рез = Справочники.ВидыКонтактнойИнформации.ПустаяСсылка();
	Иначе
		Рез = ТЗ[0].Ссылка;
	КонецЕсли;
	Возврат Рез;
КонецФункции

```
### Работа с командной строкой
ОбщийМодуль.ФайловаяСистема

### Печать
[Встраивание подсистемы] (https://its.1c.ru/db/bsp313doc#content:53:hdoc)
#### КоллекцияПечатныхФорм
БСП орава изварщенцев, на клиенте они делают массив структур, и в модуле `УправлениеПечатьюКлиент` нужно использовать массив, который готовится так:
`КоллекцияПечатныхФорм = УправлениеПечатьюКлиент.НоваяКоллекцияПечатныхФорм("БланкАнкетыЭлектронногоИнтервью");`
А вот в серверный метод "печать" в объектах нужно готовить таблицу значений:
`КоллекцияПечатныхФорм = УправлениеПечатью.ПодготовитьКоллекциюПечатныхФорм("ПФ_MXL_Т2");`
Почему в одном месте "новая", а в другом "подготовить" - на совести авторов БСП.
#### Word
[Разработка печатных форм с использованием макетов в формате офисных документов Office Open XML](https://its.1c.ru/db/bsp313doc#content:53:1:issogl2_%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0_%D0%BF%D0%B5%D1%87%D0%B0%D1%82%D0%BD%D1%8B%D1%85_%D1%84%D0%BE%D1%80%D0%BC_%D1%81_%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC_%D0%BC%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2_%D0%B2_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B5_%D0%BE%D1%84%D0%B8%D1%81%D0%BD%D1%8B%D1%85_%D0%B4%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%BE%D0%B2_office_open_xml)

[Шаблон для разработки внешней ПФ](Шаблон%20печатной%20формы%20Office%20Open%20XML.epf)

## Настройка порядка элементов
[Настрока](https://its.1c.ru/db/bsp3110doc#content:4:hdoc:issogl1_%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%BF%D0%BE%D1%80%D1%8F%D0%B4%D0%BA%D0%B0_%D1%8D%D0%BB%D0%B5%D0%BC%D0%B5%D0%BD%D1%82%D0%BE%D0%B2) (из Главы 3)
[Интерфейс](https://its.1c.ru/db/bsp3110doc#content:1185:hdoc) Из главы 4
[Пользователям](https://its.1c.ru/db/bsp3110doc/content/2341/hdoc/_top/%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0%20%D0%BF%D0%BE%D1%80%D1%8F%D0%B4%D0%BA%D0%B0%20%D1%8D%D0%BB%D0%B5%D0%BC%D0%B5%D0%BD%D1%82%D0%BE%D0%B2) гл. 5

[Подключаемые команды](Подключаемые%20команды)


# Ссылки 
[Типовые конфигурации](Типовые%20конфигурации.md)